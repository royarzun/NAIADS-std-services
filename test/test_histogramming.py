# coding=utf-8

import json
from unittest import TestCase

from clara.engine.EngineData import EngineData
from clara.engine.EngineDataType import Mimetype

from naiads.services.root.Profile1dWriterService import Profile1dWriterService


json_data = {
    "count": 2696248,
    "mean": 44595.04886494121,
    "std_dev": 2822.237747229693,
    "counts": [1556, 3960, 5684, 7504, 9528, 11676, 13972, 15952, 17836, 19788,
               21820, 23928, 26128, 28456, 30940, 33360, 35872, 38312, 40772,
               43140, 45480, 47728, 49864, 51944, 53932, 55720, 56572, 56540,
               56472, 56364, 56344, 56328, 56236, 56168, 56088, 56032, 55856,
               55904, 55864, 55632, 55584, 55544, 55384, 55412, 55168, 55156,
               55048, 54912, 53588, 51508, 49356, 47704, 45844, 43996, 42032,
               39940, 37772, 35652, 33408, 31128, 28836, 26560, 24240, 22076,
               19940, 17848, 15864, 13908, 12100, 10380, 8744, 7208, 5800,
               4128, 2412, 812, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0, 0, 0],
    "errors": [442.694791817786, 733.1046178805647, 1320.1991027704482,
               1338.4221111238571, 1167.301368807466, 1222.9181408079232,
               1297.3120308130103, 1445.1606684611124, 1693.01236004755,
               1835.0494679869485, 1924.7674577407233, 2164.9695639362835,
               2236.330895155025, 2184.063022444315, 2232.202721812249,
               2360.2895197496764, 2267.4713959393325, 2222.6555629102454,
               2264.1282941765526, 2395.9128166041273, 2572.7267451430776,
               2696.3191562841535, 2602.022003959282, 2724.1875922811546,
               3079.38007267611, 3600.1300995802426, 3482.89395204975,
               2855.69305158024, 2658.857023570176, 2722.3166152221397,
               2947.93815786585, 2581.2168193796942, 1979.1030137588148,
               1576.6106325104465, 1523.857598295665, 1076.8888499287564,
               1079.7637246457077, 989.8586544376205, 1025.1438731219255,
               1171.0275844701573, 1313.875424626619, 1203.5917762010206,
               1078.3158079132088, 1091.4532071834508, 1337.0530191161245,
               2753.7884716080757, 5049.436427099908, 5738.694267026664,
               4946.1741844122325, 2928.7781948684164, 2277.820765019208,
               1758.643284110378, 1440.0770634999656, 1384.643152389149,
               1238.9306797724503, 1219.0677889846327, 1222.6986840252414,
               1271.5767160795192, 1112.2418567536643, 955.0016287910842,
               1042.599046322613, 1027.0363160286263, 914.18578631678,
               724.5594607789382, 658.3739192204887, 527.1948873656936,
               516.7628624809682, 618.6650097273025, 500.05493933181896,
               442.3452768938829, 431.1809940922776, 394.2598698226632,
               382.00729844039057, 313.3377222105491, 269.00329607146057,
               345.38173046139735, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
               0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
               0.0, 0.0],
    "means": [39349.722365038564, 39468.229292929296, 40207.28641801548,
              40591.78144989339, 40895.465994962215, 40533.15895854745,
              40161.99799599199, 40298.279087261784, 40550.20542722583,
              41215.23549626036, 41367.70540788268, 41397.06987629555,
              41652.52770973668, 42067.21450660669, 42546.33277310924,
              42877.97841726619, 43014.51628010705, 42953.208081019,
              42985.665554792504, 42935.11265646732, 42730.30765171504,
              42730.35878310426, 43016.547569388735, 42835.16864315417,
              43090.60980493955, 43460.806101938266, 44366.28720922011,
              45031.06544039618, 45262.934976625584, 45316.90312965723,
              45133.626153627716, 45409.65154097429, 45874.72252649548,
              46107.84083463894, 46228.13878191414, 46315.58773557967,
              46274.38857061014, 46336.85997424155, 46416.1865960189,
              46403.42033362094, 46322.681850892346, 46418.70221806136,
              46384.87144301603, 46315.696311268315, 46148.56395011601,
              45777.23206904054, 44752.861357360845, 43652.67038170163,
              43834.21004702545, 44659.804069270795, 44973.81505794635,
              45143.713063894014, 45153.63004973388, 45050.087189744525,
              44952.70175104682, 45001.92138207311, 45025.6144233824,
              45062.02827330865, 44966.45486111111, 44983.430352094576,
              44792.62754889721, 44882.80873493976, 45009.675412541255,
              45110.659720963944, 45146.8704112337, 45109.113402061856,
              45041.04185577408, 44813.48921484038, 44632.0879338843,
              44559.969942196534, 44370.3087831656, 44105.049389567146,
              44020.90275862069, 43842.107558139534, 43852.52736318408,
              44025.14778325123, 43565.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
              0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
              0.0, 0.0, 0.0],
    "annotation": {
        "Title": "BrightnessTemperature_I4_Avg",
        "AidaPath": "/1D Profile/x=SolarZenithAngle_Sub/BrightnessTemperature_I4_Avg",
        "FullPath": "/Analysis Results for read-viirs/1D Profile/x=SolarZenithAngle_Sub/BrightnessTemperature_I4_Avg",
        "xAxisLabel": "SolarZenithAngle_Sub",
        "yAxisLabel": "BrightnessTemperature_I4_Avg"
    },
    "xAxis": {
        "binWidth": 0.2281964683532716,
        "centers": [31.16557566642761, 31.393772134780882, 31.621968603134153,
                    31.850165071487424, 32.07836153984069, 32.30655800819397,
                    32.53475447654724, 32.76295094490051, 32.991147413253785,
                    33.21934388160705, 33.44754034996033, 33.675736818313595,
                    33.90393328666687, 34.13212975502014, 34.36032622337341,
                    34.58852269172668, 34.816719160079955, 35.04491562843323,
                    35.2731120967865, 35.50130856513977, 35.72950503349304,
                    35.957701501846316, 36.18589797019958, 36.41409443855286,
                    36.642290906906126, 36.8704873752594, 37.09868384361267,
                    37.326880311965944, 37.55507678031921, 37.78327324867249,
                    38.01146971702576, 38.23966618537903, 38.467862653732304,
                    38.69605912208557, 38.92425559043885, 39.152452058792115,
                    39.38064852714539, 39.60884499549866, 39.83704146385193,
                    40.0652379322052, 40.293434400558475, 40.52163086891174,
                    40.74982733726502, 40.97802380561829, 41.20622027397156,
                    41.43441674232483, 41.6626132106781, 41.89080967903138,
                    42.119006147384646, 42.34720261573792, 42.57539908409119,
                    42.80359555244446, 43.03179202079773, 43.259988489151006,
                    43.488184957504274, 43.71638142585755, 43.94457789421082,
                    44.17277436256409, 44.40097083091736, 44.629167299270634,
                    44.85736376762391, 45.08556023597718, 45.31375670433045,
                    45.54195317268372, 45.770149641036994, 45.99834610939026,
                    46.22654257774354, 46.454739046096805, 46.68293551445008,
                    46.911131982803354, 47.13932845115662, 47.36752491950989,
                    47.595721387863165, 47.82391785621644, 48.05211432456971,
                    48.280310792922975, 48.50850726127625, 48.736703729629525,
                    48.96490019798279, 49.19309666633607, 49.421293134689336,
                    49.64948960304261, 49.877686071395885, 50.10588253974915,
                    50.33407900810242, 50.562275476455696, 50.79047194480897,
                    51.01866841316224, 51.246864881515506, 51.47506134986878,
                    51.703257818222056, 51.931454286575324, 52.15965075492859,
                    52.38784722328187, 52.61604369163514, 52.844240159988416,
                    53.072436628341684, 53.30063309669495, 53.52882956504823,
                    53.7570260334015]
    }
}


class TestProfile1dWriterService(TestCase):

    def setUp(self):
        self.engine_data = EngineData()
        self.engine_data.set_data(Mimetype.STRING, json.dumps(json_data))

    def test_execute(self):
        histo_service = Profile1dWriterService()
        self.assertIsInstance(histo_service.execute(self.engine_data),
                              EngineData)
